<html><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1"name=viewport><title>Coffee Sensor Administration</title><link href=/assets/bootstrap.min.css rel=stylesheet><style>body,html{font-size:14px}body{background-color:#eef2f7}h1{font-weight:400;font-size:34px;line-height:40px}h2{font-weight:400;font-size:24px;line-height:32px}h3{font-weight:400;font-size:20px;line-height:28px}.layout{max-width:750px;margin:0 auto}.block{box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);padding:1em 2em;border-radius:3px;margin-bottom:1em;background:#fff}.block--no-padding{padding:0}.block:not(.block--no-padding)>h2,.block:not(.block--no-padding)>h3{margin-top:0}@media all and (max-width:720px){.btn-sm-block{display:block;width:100%}}</style></head><body><main class=container><div class="row justify-content-md-center"><div class="col col-lg-9"><div class="row my-5"><div class="col col-md-10 col-sm-12"><h1>Coffee Sensor Administration</h1></div></div><div class=row><div class=col><h2 class=my-3>System status</h2></div></div><div class=row><div class=col><div class="block block--no-padding"><table class=table><thead class=thead-dark><tr><th colspan=2>Wi-Fi</th></tr></thead><tbody><tr><td>WiFi.status()</td><td id=data-wifi-status></td></tr></tbody><thead class=thead-dark><tr><th colspan=2>Memory</th></tr></thead><tbody><tr><td>ESP.getFreeHeap()</td><td id=data-free-heap></td></tr></tbody></table></div></div></div><div class=row><div class=col><h2 class=my-3>Scale calibration</h2></div></div><div class=row><div class=col><div class="block block--no-padding"><div class=row><div class=col><ol class=pt-3><li>Set <b>Scale multiplier</b> to <code>1.0</code> and press Save.</li><li>Press <b>Tare</b>.</li><li>Place a known weight on the scale, wait a second, and refresh this page.</li><li>Divide the <b>Current weight</b> by your known weight. This is the approximate value for <b>Scale multiplier</b>.</li><li>Adjust the parameter in step 4 until you get an accurate reading.</li></ol></div></div><table class="table mb-0"><tbody><tr><th scope=row>Current weight</th><td colspan=2 id=data-scale-current-weight></td></tr><tr><th scope=row>Scale multiplier (<code>set_scale</code>)</th><td><form action=/persist/scale/multiplier method=POST><div class="input-group input-group-sm"><input class=form-control id=data-tare-scale-multiplier name=scale.multiplier type=number step=0.1><div class=input-group-append><button class="btn btn-sm btn-outline-secondary"type=submit>Save</button></div></div></form></td></tr><tr><td colspan=2>The HX711 module uses this multiplier to scale the calculated values.</td></tr><tr><th scope=row>Scale offset (<code>set_offset</code>)</th><td><form action=/persist/scale/offset method=POST><div class="input-group input-group-sm"><input class=form-control id=data-tare-scale-offset name=scale.offset type=number step=0.1 style=width:200px><div class=input-group-append><button class="btn btn-sm btn-outline-secondary"type=submit>Save</button></div></div></form></td></tr><tr><td colspan=2>The current raw tare offset. This value is added to the reading to offset the weight.</td></tr><tr><th scope=row class=fullwidth>Tare</th><td><form action=/persist/scale/tare method=POST><div class="input-group input-group-sm"><button class="btn btn-sm btn-outline-primary"type=submit>tare()</button></div></form></td></tr><tr><td colspan=2>Let sensor calculate the <b>Scale offset</b> from the current weight.</td></tr></tbody></table></div></div></div><div class=row><div class=col><h2 class=my-3>Wi-Fi configuration</h2></div></div><div class=row><div class=col><div class=block><div class=row><div class=col><form action=/persist/wifi method=post enctype=application/x-www-form-urlencoded><h3>Set Wi-fi client credentials</h3><hr><div class=form-group><label for=wifiSSID>SSID</label> <input class=form-control id=wifiSSID name=wifi.ssid maxlength=32 placeholder="Access Point name"required minlength=1></div><div class=form-group><label for=wifiPassword>Password</label> <input class=form-control id=wifiPassword name=wifi.password maxlength=63 placeholder=Password required minlength=8 type=password></div><hr><div class=form-group><button class="btn btn-primary btn-sm-block"type=submit>Save</button></div></form></div></div></div></div></div><div class=row><div class=col><h2 class=my-3>WebSocket configuration</h2></div></div><div class=row><div class=col><div class=block><div class=row><div class=col><form action=/persist/ws method=post enctype=application/x-www-form-urlencoded><h3>Set server WebSocket URL</h3><hr><div class=form-group><label for=websocketURL>SSID</label> <input class=form-control id=websocketURL name=ws.url maxlength=255 placeholder=wss://example.com:443/ws required></div><hr><div class=form-group><button class="btn btn-primary btn-sm-block"type=submit>Save</button></div></form></div></div></div></div></div></div></div></main><script>(async()=>{const e=await fetch("/api/status");if(200!==e.status)return void alert(`Server error, please see your browser's developer tools' network tab! Response code: ${e.status}`);let t;try{t=await e.json()}catch(e){return console.error("Malformed JSON",e),void alert("Server sent malformed JSON! Please see your browser's developer tools' network tab.")}const a=document.getElementById.bind(document),{wifiStatus:r,freeHeap:s,currentSavedSSID:o,currentPasswordLen:l,websocketURL:n,scaleMultiplier:i,scaleOffset:c,scaleReading:d}=t;a("data-wifi-status").innerText=r,a("data-free-heap").innerText=s>1e4?`${(s/1e3).toFixed(3)} KB`:`${s} B`,a("data-scale-current-weight").innerText=`${d}`;const u=a("wifiSSID"),w=a("wifiPassword"),f=a("websocketURL"),v=a("data-tare-scale-multiplier"),p=a("data-tare-scale-offset");u.value.length<=0&&o&&(u.value=o),l>0&&(w.placeholder="â€¢".repeat(l>63?63:l)),f.value.length<=0&&n&&(f.value=n),v.value=i,p.value=c})();</script></body></html>